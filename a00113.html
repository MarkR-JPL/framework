<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ReFRACtor: FullPhysics::ConnorSolverMAP Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ReFRACtor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00113.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="a02301.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FullPhysics::ConnorSolverMAP Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This solves a nonlinear least squares problem using Levenberg-Marquardt.  
 <a href="a00113.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00608_source.html">connor_solver_map.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for FullPhysics::ConnorSolverMAP:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="a02302.png" border="0" usemap="#_full_physics_1_1_connor_solver_m_a_p_inherit__map" alt="Inheritance graph"/></div>
<map name="_full_physics_1_1_connor_solver_m_a_p_inherit__map" id="_full_physics_1_1_connor_solver_m_a_p_inherit__map">
<area shape="rect" id="node2" href="a00364.html" title="The base class for the solvers of the Nonlinear&#45;Least&#45;Squares Problem. " alt="" coords="25,829,193,951"/>
<area shape="rect" id="node3" href="a00218.html" title="The base class for all iterative optimizers that use first order derivatives. " alt="" coords="7,616,210,781"/>
<area shape="rect" id="node4" href="a00217.html" title="The base class for all iterative optimizers. " alt="" coords="15,271,202,568"/>
<area shape="rect" id="node5" href="a00415.html" title="{FullPhysics::Printable\l\&lt; IterativeSolver \&gt;\n||+ print_to_string()\l}" alt="" coords="34,131,183,223"/>
<area shape="rect" id="node6" href="a00171.html" title="For use with SWIG, it is useful to have a base class that everything can be cast to. " alt="" coords="18,5,199,83"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for FullPhysics::ConnorSolverMAP:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="a02303.png" border="0" usemap="#_full_physics_1_1_connor_solver_m_a_p_coll__map" alt="Collaboration graph"/></div>
<map name="_full_physics_1_1_connor_solver_m_a_p_coll__map" id="_full_physics_1_1_connor_solver_m_a_p_coll__map">
<area shape="rect" id="node2" href="a00364.html" title="The base class for the solvers of the Nonlinear&#45;Least&#45;Squares Problem. " alt="" coords="241,1188,409,1309"/>
<area shape="rect" id="node3" href="a00218.html" title="The base class for all iterative optimizers that use first order derivatives. " alt="" coords="224,960,427,1125"/>
<area shape="rect" id="node4" href="a00217.html" title="The base class for all iterative optimizers. " alt="" coords="223,273,409,571"/>
<area shape="rect" id="node5" href="a00415.html" title="{FullPhysics::Printable\l\&lt; IterativeSolver \&gt;\n||+ print_to_string()\l}" alt="" coords="241,132,391,224"/>
<area shape="rect" id="node6" href="a00171.html" title="For use with SWIG, it is useful to have a base class that everything can be cast to. " alt="" coords="328,5,509,83"/>
<area shape="rect" id="node14" href="a00415.html" title="{FullPhysics::Printable\l\&lt; FitStatistic \&gt;\n||+ print_to_string()\l}" alt="" coords="415,132,564,224"/>
<area shape="rect" id="node7" href="a00443.html" title="{boost::shared_ptr\&lt;\l FullPhysics::NLLSProblem \&gt;\n||}" alt="" coords="5,997,200,1089"/>
<area shape="rect" id="node8" href="a00443.html" title="{boost::shared_ptr\&lt;\l FullPhysics::MaxAPosteriori \&gt;\n||}" alt="" coords="519,1203,721,1295"/>
<area shape="rect" id="node9" title="STL class. " alt="" coords="745,1210,825,1287"/>
<area shape="rect" id="node10" title="STL class. " alt="" coords="722,997,849,1089"/>
<area shape="rect" id="node11" href="a00443.html" title="{boost::shared_ptr\&lt;\l FullPhysics::NLLSProblemScaled \&gt;\n||}" alt="" coords="849,1203,1084,1295"/>
<area shape="rect" id="node12" href="a00443.html" title="{boost::shared_ptr\&lt;\l FullPhysics::ConvergenceCheck \&gt;\n||}" alt="" coords="1108,1203,1337,1295"/>
<area shape="rect" id="node13" href="a00152.html" title="This class holds various parameters describing how good of a fit we have. " alt="" coords="401,595,567,936"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a8cef3cf27ce873edf2870083cf9b0de0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">status_t</a> { <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a20713b5938508e525d81cd1f0d242e4c">SUCCESS</a>, 
<a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a2d914b2efc926e5be7d27175eb0b4bc5">CONTINUE</a>, 
<a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a47873968f8cb6a80247bde3561307edb">ERROR</a>, 
<a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a4f6402de0c388c22f2d148bcfa6e228d">UNTRIED</a>
 }<tr class="memdesc:a8cef3cf27ce873edf2870083cf9b0de0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum type for the status of the iterative solver.  <a href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a8cef3cf27ce873edf2870083cf9b0de0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a60e8aeddbbb43c731a5e3735c1667a9b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a60e8aeddbbb43c731a5e3735c1667a9b">ConnorSolverMAP</a> (int max_cost_function_calls, double dx_tol_abs, double dx_tol_rel, double g_tol_abs, const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00359.html">NLLSMaxAPosteriori</a> &gt; &amp;NLLS_MAP, const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00118.html">ConvergenceCheck</a> &gt; &amp;Convergence_check, bool vrbs=false, double Gamma_initial=0.0, const std::string &amp;Fname_test_data=&quot;&quot;)</td></tr>
<tr class="memdesc:a60e8aeddbbb43c731a5e3735c1667a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">and optionally an initial value for gamma.  <a href="#a60e8aeddbbb43c731a5e3735c1667a9b">More...</a><br /></td></tr>
<tr class="separator:a60e8aeddbbb43c731a5e3735c1667a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af267d010867861ace7d657e243064d98"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#af267d010867861ace7d657e243064d98">~ConnorSolverMAP</a> ()</td></tr>
<tr class="separator:af267d010867861ace7d657e243064d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7568ed8123ba65605139d6c773c010fd"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; blitz::Array&lt; double, 1 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd">accepted_points</a> () const </td></tr>
<tr class="memdesc:a7568ed8123ba65605139d6c773c010fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector (std) of accepted points.  <a href="#a7568ed8123ba65605139d6c773c010fd">More...</a><br /></td></tr>
<tr class="separator:a7568ed8123ba65605139d6c773c010fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8dbb9ff0d91ee16181882ca8900240c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00118.html">ConvergenceCheck</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ac8dbb9ff0d91ee16181882ca8900240c">convergence_check</a> () const </td></tr>
<tr class="memdesc:ac8dbb9ff0d91ee16181882ca8900240c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The convergence check object.  <a href="#ac8dbb9ff0d91ee16181882ca8900240c">More...</a><br /></td></tr>
<tr class="separator:ac8dbb9ff0d91ee16181882ca8900240c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6214f60b16b9c2070ee3578eb8e1ceb4"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a6214f60b16b9c2070ee3578eb8e1ceb4">cost_at_accepted_points</a> () const </td></tr>
<tr class="memdesc:a6214f60b16b9c2070ee3578eb8e1ceb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector (std) of cost function values at accepted points.  <a href="#a6214f60b16b9c2070ee3578eb8e1ceb4">More...</a><br /></td></tr>
<tr class="separator:a6214f60b16b9c2070ee3578eb8e1ceb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ec3a87182af5bbc9abe8f2ac9d353d"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="a00152.html">FitStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a76ec3a87182af5bbc9abe8f2ac9d353d">fit_statistic</a> () const </td></tr>
<tr class="memdesc:a76ec3a87182af5bbc9abe8f2ac9d353d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return fit results for solution to last problem solved.  <a href="#a76ec3a87182af5bbc9abe8f2ac9d353d">More...</a><br /></td></tr>
<tr class="separator:a76ec3a87182af5bbc9abe8f2ac9d353d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac608ffd868efc0a928d82f08edcfc380"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ac608ffd868efc0a928d82f08edcfc380">gamma_last_step</a> () const </td></tr>
<tr class="memdesc:ac608ffd868efc0a928d82f08edcfc380"><td class="mdescLeft">&#160;</td><td class="mdescRight">Levenberg-Marquardt parameter for last step we processed.  <a href="#ac608ffd868efc0a928d82f08edcfc380">More...</a><br /></td></tr>
<tr class="separator:ac608ffd868efc0a928d82f08edcfc380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b51e5f9f34881f575f784b47b0f5ea6"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; blitz::Array&lt; double, 1 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00218.html#a6b51e5f9f34881f575f784b47b0f5ea6">gradient_at_accepted_points</a> () const </td></tr>
<tr class="memdesc:a6b51e5f9f34881f575f784b47b0f5ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector (std) of gradients evaluated at accepted points.  <a href="#a6b51e5f9f34881f575f784b47b0f5ea6">More...</a><br /></td></tr>
<tr class="separator:a6b51e5f9f34881f575f784b47b0f5ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ec4738086b19e7c6aa86b8e3e9acc8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00361.html">NLLSProblem</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00364.html#a74ec4738086b19e7c6aa86b8e3e9acc8">nlls_problem</a> () const </td></tr>
<tr class="memdesc:a74ec4738086b19e7c6aa86b8e3e9acc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Nonlinear Least Squares problem.  <a href="#a74ec4738086b19e7c6aa86b8e3e9acc8">More...</a><br /></td></tr>
<tr class="separator:a74ec4738086b19e7c6aa86b8e3e9acc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fad568a9f82d6f4e94ebf73ad1aaccd"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd">num_accepted_steps</a> () const </td></tr>
<tr class="memdesc:a0fad568a9f82d6f4e94ebf73ad1aaccd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of the accepted steps.  <a href="#a0fad568a9f82d6f4e94ebf73ad1aaccd">More...</a><br /></td></tr>
<tr class="separator:a0fad568a9f82d6f4e94ebf73ad1aaccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d81ce0f4c9e8efafbbd23c23e7a269c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a1d81ce0f4c9e8efafbbd23c23e7a269c">number_divergent</a> () const </td></tr>
<tr class="memdesc:a1d81ce0f4c9e8efafbbd23c23e7a269c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of divergent steps for the last problem solved.  <a href="#a1d81ce0f4c9e8efafbbd23c23e7a269c">More...</a><br /></td></tr>
<tr class="separator:a1d81ce0f4c9e8efafbbd23c23e7a269c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2563b65563de033007dbd2917937d256"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a2563b65563de033007dbd2917937d256">number_iteration</a> () const </td></tr>
<tr class="memdesc:a2563b65563de033007dbd2917937d256"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of iterations for the last problem solved.  <a href="#a2563b65563de033007dbd2917937d256">More...</a><br /></td></tr>
<tr class="separator:a2563b65563de033007dbd2917937d256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8108048f2c1a3c7bbbdd013f03c14c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a3f8108048f2c1a3c7bbbdd013f03c14c">outcome_flag</a> () const </td></tr>
<tr class="memdesc:a3f8108048f2c1a3c7bbbdd013f03c14c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outcome flag. This is an integer version of <a class="el" href="a00152.html#ae80086617c04b5be0cee34f8b9867e23">FitStatistic::OUTCOME</a>.  <a href="#a3f8108048f2c1a3c7bbbdd013f03c14c">More...</a><br /></td></tr>
<tr class="separator:a3f8108048f2c1a3c7bbbdd013f03c14c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77aa5ef807ed695fe12e215834190980"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a77aa5ef807ed695fe12e215834190980">print</a> (std::ostream &amp;Os) const </td></tr>
<tr class="memdesc:a77aa5ef807ed695fe12e215834190980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints description of object.  <a href="#a77aa5ef807ed695fe12e215834190980">More...</a><br /></td></tr>
<tr class="separator:a77aa5ef807ed695fe12e215834190980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00415.html#adb52c1f4ab60cbabfdcb8aa32fac7b20">print_to_string</a> () const</td></tr>
<tr class="memdesc:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print to string.  <a href="#adb52c1f4ab60cbabfdcb8aa32fac7b20">More...</a><br /></td></tr>
<tr class="separator:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27a6d6002b04d3f21be8258a0e90a9bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a27a6d6002b04d3f21be8258a0e90a9bf">record_accepted_point</a> (const blitz::Array&lt; double, 1 &gt; &amp;point)</td></tr>
<tr class="memdesc:a27a6d6002b04d3f21be8258a0e90a9bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to record an accepted point.  <a href="#a27a6d6002b04d3f21be8258a0e90a9bf">More...</a><br /></td></tr>
<tr class="separator:a27a6d6002b04d3f21be8258a0e90a9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af982397b15209de479477b2604717871"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#af982397b15209de479477b2604717871">record_cost_at_accepted_point</a> (double cost)</td></tr>
<tr class="memdesc:af982397b15209de479477b2604717871"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to record the cost function value at an accepted point.  <a href="#af982397b15209de479477b2604717871">More...</a><br /></td></tr>
<tr class="separator:af982397b15209de479477b2604717871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae9aa2825e60454d25c3ce201af12c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00218.html#acae9aa2825e60454d25c3ce201af12c2">record_gradient_at_accepted_point</a> (const blitz::Array&lt; double, 1 &gt; &amp;gradient)</td></tr>
<tr class="memdesc:acae9aa2825e60454d25c3ce201af12c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">For recording the gradient of the cost function evaluated at an accepted point.  <a href="#acae9aa2825e60454d25c3ce201af12c2">More...</a><br /></td></tr>
<tr class="separator:acae9aa2825e60454d25c3ce201af12c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d67c485668fec2852207810e34d9fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ab0d67c485668fec2852207810e34d9fe">solve</a> ()</td></tr>
<tr class="memdesc:ab0d67c485668fec2852207810e34d9fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">This solves the least squares problem starting at the initial guess.  <a href="#ab0d67c485668fec2852207810e34d9fe">More...</a><br /></td></tr>
<tr class="separator:ab0d67c485668fec2852207810e34d9fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9579c6b1338073e9c713c1e04f44c50a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a9579c6b1338073e9c713c1e04f44c50a">status</a> () const </td></tr>
<tr class="memdesc:a9579c6b1338073e9c713c1e04f44c50a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a value of <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0" title="Enum type for the status of the iterative solver. ">IterativeSolver::status_t</a> type.  <a href="#a9579c6b1338073e9c713c1e04f44c50a">More...</a><br /></td></tr>
<tr class="separator:a9579c6b1338073e9c713c1e04f44c50a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d2190c446abd256bf0adc82ca6ba54"><td class="memItemLeft" align="right" valign="top">virtual const char *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a31d2190c446abd256bf0adc82ca6ba54">status_str</a> () const </td></tr>
<tr class="memdesc:a31d2190c446abd256bf0adc82ca6ba54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the string version of the solver status.  <a href="#a31d2190c446abd256bf0adc82ca6ba54">More...</a><br /></td></tr>
<tr class="separator:a31d2190c446abd256bf0adc82ca6ba54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8151e8281ad0cb5936fd3362a0a77e6"><td class="memItemLeft" align="right" valign="top">blitz::Array&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#af8151e8281ad0cb5936fd3362a0a77e6">x_update</a> () const </td></tr>
<tr class="memdesc:af8151e8281ad0cb5936fd3362a0a77e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the a priori of the last problem solved.  <a href="#af8151e8281ad0cb5936fd3362a0a77e6">More...</a><br /></td></tr>
<tr class="separator:af8151e8281ad0cb5936fd3362a0a77e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8a3e17acdd18b2439b55003ae5e98fca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a8a3e17acdd18b2439b55003ae5e98fca">do_inversion</a> ()</td></tr>
<tr class="memdesc:a8a3e17acdd18b2439b55003ae5e98fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">This does an inversion step.  <a href="#a8a3e17acdd18b2439b55003ae5e98fca">More...</a><br /></td></tr>
<tr class="separator:a8a3e17acdd18b2439b55003ae5e98fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad6643af553c077ab1b469688450e0c39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00118.html">ConvergenceCheck</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ad6643af553c077ab1b469688450e0c39">convergence_check_</a></td></tr>
<tr class="memdesc:ad6643af553c077ab1b469688450e0c39"><td class="mdescLeft">&#160;</td><td class="mdescRight">The convergence check object.  <a href="#ad6643af553c077ab1b469688450e0c39">More...</a><br /></td></tr>
<tr class="separator:ad6643af553c077ab1b469688450e0c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf9a8bcdb3c3a5e09d1310a9b22ed21"><td class="memItemLeft" align="right" valign="top">blitz::Array&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a3bf9a8bcdb3c3a5e09d1310a9b22ed21">dx</a></td></tr>
<tr class="memdesc:a3bf9a8bcdb3c3a5e09d1310a9b22ed21"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is <img class="formulaInl" alt="$d{x}_{i + 1}$" src="form_11.png"/> the update to <img class="formulaInl" alt="$\mathbf{x}_i$" src="form_12.png"/>, <img class="formulaInl" alt="$\mathbf{y} - \mathbf{F}(\mathbf{x}_i)$" src="form_10.png"/>.  <a href="#a3bf9a8bcdb3c3a5e09d1310a9b22ed21">More...</a><br /></td></tr>
<tr class="separator:a3bf9a8bcdb3c3a5e09d1310a9b22ed21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0afeddb3a8dce64fcc3a4160c8051777"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a0afeddb3a8dce64fcc3a4160c8051777">dX_tol_abs</a></td></tr>
<tr class="separator:a0afeddb3a8dce64fcc3a4160c8051777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f034cec23dd9567cc047af41a904c3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a91f034cec23dd9567cc047af41a904c3">dX_tol_rel</a></td></tr>
<tr class="separator:a91f034cec23dd9567cc047af41a904c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4810c323a772984382fdcc6c15602bf5"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a4810c323a772984382fdcc6c15602bf5">fname_test_data</a></td></tr>
<tr class="memdesc:a4810c323a772984382fdcc6c15602bf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">If this isn't an empty string, save to this file in the first iteration.  <a href="#a4810c323a772984382fdcc6c15602bf5">More...</a><br /></td></tr>
<tr class="separator:a4810c323a772984382fdcc6c15602bf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395d9eb4db3625e59e21b16a2ce1a6cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00152.html">FitStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a395d9eb4db3625e59e21b16a2ce1a6cc">fstat</a></td></tr>
<tr class="memdesc:a395d9eb4db3625e59e21b16a2ce1a6cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results from last fit step.  <a href="#a395d9eb4db3625e59e21b16a2ce1a6cc">More...</a><br /></td></tr>
<tr class="separator:a395d9eb4db3625e59e21b16a2ce1a6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5700d09c82c6e5e351c88a8408607481"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00218.html#a5700d09c82c6e5e351c88a8408607481">G_tol_abs</a></td></tr>
<tr class="separator:a5700d09c82c6e5e351c88a8408607481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3403f2fbb3c08ecb62470759a8c74b13"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a3403f2fbb3c08ecb62470759a8c74b13">gamma</a></td></tr>
<tr class="memdesc:a3403f2fbb3c08ecb62470759a8c74b13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Levenberg-Marquardt <img class="formulaInl" alt="$\gamma$" src="form_7.png"/> parameter.  <a href="#a3403f2fbb3c08ecb62470759a8c74b13">More...</a><br /></td></tr>
<tr class="separator:a3403f2fbb3c08ecb62470759a8c74b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ac957c34ec144b6f50a00865b7b270"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ab3ac957c34ec144b6f50a00865b7b270">gamma_initial</a></td></tr>
<tr class="memdesc:ab3ac957c34ec144b6f50a00865b7b270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial value of gamma.  <a href="#ab3ac957c34ec144b6f50a00865b7b270">More...</a><br /></td></tr>
<tr class="separator:ab3ac957c34ec144b6f50a00865b7b270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4966f53d4cfa86ea57795bad9763e41c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a4966f53d4cfa86ea57795bad9763e41c">gamma_last_step_</a></td></tr>
<tr class="memdesc:a4966f53d4cfa86ea57795bad9763e41c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stash gamma from last step we processed.  <a href="#a4966f53d4cfa86ea57795bad9763e41c">More...</a><br /></td></tr>
<tr class="separator:a4966f53d4cfa86ea57795bad9763e41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a2fb1dc3c965cdea6d879c7e5db31c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00341.html">MaxAPosteriori</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a52a2fb1dc3c965cdea6d879c7e5db31c">map</a></td></tr>
<tr class="separator:a52a2fb1dc3c965cdea6d879c7e5db31c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78d9d2767f3ee53f52d0d57148b7ca5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#ad78d9d2767f3ee53f52d0d57148b7ca5">max_cost_f_calls</a></td></tr>
<tr class="separator:ad78d9d2767f3ee53f52d0d57148b7ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f65f85f3cc0f937c39626a589733e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00361.html">NLLSProblem</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00364.html#a60f65f85f3cc0f937c39626a589733e3">P</a></td></tr>
<tr class="separator:a60f65f85f3cc0f937c39626a589733e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac04a82509ebf348c7c1e4895fa223b1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00362.html">NLLSProblemScaled</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#ac04a82509ebf348c7c1e4895fa223b1b">scaled_p</a></td></tr>
<tr class="separator:ac04a82509ebf348c7c1e4895fa223b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c54bf6f447542be16f78f6da78261b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a2c54bf6f447542be16f78f6da78261b1">stat</a></td></tr>
<tr class="separator:a2c54bf6f447542be16f78f6da78261b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db313c529ed9d698ddbb175cf86e4d3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00217.html#a1db313c529ed9d698ddbb175cf86e4d3">verbose</a></td></tr>
<tr class="separator:a1db313c529ed9d698ddbb175cf86e4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a240449ed16d0822b51071de8fdbdf8ee"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00113.html#a240449ed16d0822b51071de8fdbdf8ee">rcond</a> = 1e-12</td></tr>
<tr class="memdesc:a240449ed16d0822b51071de8fdbdf8ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor to determine if we treat a singular factor as 0.  <a href="#a240449ed16d0822b51071de8fdbdf8ee">More...</a><br /></td></tr>
<tr class="separator:a240449ed16d0822b51071de8fdbdf8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This solves a nonlinear least squares problem using Levenberg-Marquardt. </p>
<p>This is the code that was originally written by Brian Connor.</p>
<p>We've rewritten the code in C++. This in entirely a matter a convenience, the wrapper code for calling the older Fortran code was bigger than the routine we were calling, so it made more sense just to duplicate the algorithm. We can revisit this if there is a reason to move this back to Fortran.</p>
<p>This solver is able to handle rank deficient Jacobians (e.g., we have parameters that are ignored).</p>
<p>At each iteration, this solves</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left((1+\gamma) \mathbf{S}_a^{-1} + \mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \mathbf{K}_i\right) d\mathbf{x}_{i+1} = \left[\mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \left(\mathbf{y} - \mathbf{F}(\mathbf{x}_i)\right) + \mathbf{S}_a^{-1}(\mathbf{x}_a - \mathbf{x}_i)\right] \]" src="form_0.png"/>
</p>
<p>This class has a "do_inversion" private member that is a bit difficult to test. As an aid to testing, the constructor takes a optional file name. If that name is passed, then we dump the state of this class in the first iteration of the solver to that file. We can then rerun the do_inversion by passing this file name to "test_do_inversion", which sets up the state, calls, do_inversion, and returns the results. This is entirely for use in unit testing, you wouldn't call this in normal operation.</p>
<p>This class is an <a class="el" href="a00373.html" title="Mixin for a class that allows other classes to observe it state. ">Observable</a>, any registered <a class="el" href="a00377.html" title="Simple Mixin to be and Observer of another object of class T. ">Observer</a> will get notified after each iteration of the solver. This can be used to do things like add iteration output or extra logging. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00052">52</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a8cef3cf27ce873edf2870083cf9b0de0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">FullPhysics::IterativeSolver::status_t</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enum type for the status of the iterative solver. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a8cef3cf27ce873edf2870083cf9b0de0a20713b5938508e525d81cd1f0d242e4c"></a>SUCCESS&#160;</td><td class="fielddoc">
<p>solve method called and a solution found </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a8cef3cf27ce873edf2870083cf9b0de0a2d914b2efc926e5be7d27175eb0b4bc5"></a>CONTINUE&#160;</td><td class="fielddoc">
<p>solve method called but did not converge to a solution </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a8cef3cf27ce873edf2870083cf9b0de0a47873968f8cb6a80247bde3561307edb"></a>ERROR&#160;</td><td class="fielddoc">
<p>solve method called but an error was encountered </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a8cef3cf27ce873edf2870083cf9b0de0a4f6402de0c388c22f2d148bcfa6e228d"></a>UNTRIED&#160;</td><td class="fielddoc">
<p>solve method not called yet </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="a00848_source.html#l00048">48</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a60e8aeddbbb43c731a5e3735c1667a9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FullPhysics::ConnorSolverMAP::ConnorSolverMAP </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_cost_function_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx_tol_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dx_tol_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g_tol_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00359.html">NLLSMaxAPosteriori</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>NLLS_MAP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt; <a class="el" href="a00118.html">ConvergenceCheck</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Convergence_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>vrbs</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gamma_initial</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Fname_test_data</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>and optionally an initial value for gamma. </p>
<p>See the comments above this class for the "save_test_data" argument. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00059">59</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="af267d010867861ace7d657e243064d98"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual FullPhysics::ConnorSolverMAP::~ConnorSolverMAP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00608_source.html#l00071">71</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7568ed8123ba65605139d6c773c010fd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; blitz::Array&lt;double, 1&gt; &gt; FullPhysics::IterativeSolver::accepted_points </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a vector (std) of accepted points. </p>
<p>This method returns a std vector of accepted points in the parameter space. The initial starting point is always an accepted point. Then the second accepted point is the point obtained after taking the first accepted step from the initial (first) point. The third accepted point is the point obtained after taking the second accepted step from the second accepted point and so on.</p>
<p>In other words, if the initial point and all the accepted points after taking the accepted steps are recorded correctly, then</p><ul>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[0] is the initial starting point,</li>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1] is the point obtained after taking the first accepted step from the initial point,</li>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[2] is the point obtained after taking the second accepted step from <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1] point,</li>
<li>...</li>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[<a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a>] is the last accepted point obtained after the last accepted step.</li>
</ul>
<p>Therefore, if the recording of the accepted points is done correctly, and <a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a> returns 2, then</p><ul>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1] - <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[0] is the first accepted step, and</li>
<li><a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[2] - <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1] is the second accepted step</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>A vector of accepted points </dd></dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00132">132</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac8dbb9ff0d91ee16181882ca8900240c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00118.html">ConvergenceCheck</a>&gt; FullPhysics::ConnorSolverMAP::convergence_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The convergence check object. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00087">87</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6214f60b16b9c2070ee3578eb8e1ceb4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; FullPhysics::IterativeSolver::cost_at_accepted_points </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a vector (std) of cost function values at accepted points. </p>
<p>This method returns a std vector of cost function values computed at the accepted points. In other words, if the accepted points and the cost function values at these points are recorded correctly, then</p><ul>
<li><a class="el" href="a00217.html#a6214f60b16b9c2070ee3578eb8e1ceb4" title="Returns a vector (std) of cost function values at accepted points. ">cost_at_accepted_points()</a>[0] is the value of the cost function at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[0]</li>
<li><a class="el" href="a00217.html#a6214f60b16b9c2070ee3578eb8e1ceb4" title="Returns a vector (std) of cost function values at accepted points. ">cost_at_accepted_points()</a>[1] is the value of the cost function at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1]</li>
<li>...</li>
<li>and finally <a class="el" href="a00217.html#a6214f60b16b9c2070ee3578eb8e1ceb4" title="Returns a vector (std) of cost function values at accepted points. ">cost_at_accepted_points()</a>[<a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a>] is the value of the cost function at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[<a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a>]</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>A vector of cost function values at accepted points </dd></dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00156">156</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8a3e17acdd18b2439b55003ae5e98fca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConnorSolverMAP::do_inversion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This does an inversion step. </p>
<p>For this we solve the system</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left((1+\gamma) \mathbf{S}_a^{-1} + \mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \mathbf{K}_i\right) d\mathbf{x}_{i+1} = \left[\mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \left(\mathbf{y} - \mathbf{F}(\mathbf{x}_i)\right) + \mathbf{S}_a^{-1}(\mathbf{x}_a - \mathbf{x}_i)\right] \]" src="form_0.png"/>
</p>
<p>Note, to improve numerical stability we scale the system by</p>
<p><img class="formulaInl" alt="$\mathbf{N} = \sqrt{diag \mathbf{S}_a}$" src="form_1.png"/> and solve the system</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{N}^T \left((1+\gamma) \mathbf{S}_a^{-1} + \mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \mathbf{K}_i\right) \mathbf{N} \left( \mathbf{N}^{-1} d\mathbf{x}_{i+1} \right) = \mathbf{N}^T \left[\mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \left(\mathbf{y} - \mathbf{F}(\mathbf{x}_i)\right) + \mathbf{S}_a^{-1}(\mathbf{x}_a - \mathbf{x}_i)\right] \]" src="form_2.png"/>
</p>
<p>To help with testing for convergence, we also calculate:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ d \sigma^2 = \left(d\mathbf{x}_{i+1}\right)^T \left[\mathbf{K}_i^T \mathbf{S}_{\epsilon}^{-1} \left(\mathbf{y} - \mathbf{F}(\mathbf{x}_i)\right) + \mathbf{S}_a^{-1}(\mathbf{x}_a - \mathbf{x}_i)\right] \]" src="form_3.png"/>
</p>
<p>This calculates the values kt_se_m1_k, dx, and fstat. </p>

<p>Definition at line <a class="el" href="a00607_source.html#l00168">168</a> of file <a class="el" href="a00607_source.html">connor_solver_map.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a76ec3a87182af5bbc9abe8f2ac9d353d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="a00152.html">FitStatistic</a> FullPhysics::ConnorSolverMAP::fit_statistic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return fit results for solution to last problem solved. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00122">122</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac608ffd868efc0a928d82f08edcfc380"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::ConnorSolverMAP::gamma_last_step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Levenberg-Marquardt parameter for last step we processed. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00080">80</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6b51e5f9f34881f575f784b47b0f5ea6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; blitz::Array&lt;double, 1&gt; &gt; FullPhysics::IterativeSolverDer::gradient_at_accepted_points </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a vector (std) of gradients evaluated at accepted points. </p>
<p>This method returns a std vector of gradients computed at the accepted points. In other words, if the accepted points and the computed gradients at these points are recorded correctly, then</p><ul>
<li><a class="el" href="a00218.html#a6b51e5f9f34881f575f784b47b0f5ea6" title="Returns a vector (std) of gradients evaluated at accepted points. ">gradient_at_accepted_points()</a>[0] is the gradient of the cost function evaluated at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[0]</li>
<li><a class="el" href="a00218.html#a6b51e5f9f34881f575f784b47b0f5ea6" title="Returns a vector (std) of gradients evaluated at accepted points. ">gradient_at_accepted_points()</a>[1] is the gradient of the cost function evaluated at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[1]</li>
<li>...</li>
<li>and finally <a class="el" href="a00218.html#a6b51e5f9f34881f575f784b47b0f5ea6" title="Returns a vector (std) of gradients evaluated at accepted points. ">gradient_at_accepted_points()</a>[<a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a>] is the gradient of the cost function evaluated at <a class="el" href="a00217.html#a7568ed8123ba65605139d6c773c010fd" title="Returns a vector (std) of accepted points. ">accepted_points()</a>[<a class="el" href="a00217.html#a0fad568a9f82d6f4e94ebf73ad1aaccd" title="Returns the number of the accepted steps. ">num_accepted_steps()</a>] </li>
</ul>

<p>Definition at line <a class="el" href="a00850_source.html#l00076">76</a> of file <a class="el" href="a00850_source.html">iterative_solver_der.h</a>.</p>

</div>
</div>
<a class="anchor" id="a74ec4738086b19e7c6aa86b8e3e9acc8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00361.html">NLLSProblem</a>&gt;&amp; FullPhysics::NLLSSolver::nlls_problem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the Nonlinear Least Squares problem. </p>
<p>This method returns the Nonlinear Least Squares problem that is passed to the constructor of the solver.</p>
<dl class="section return"><dt>Returns</dt><dd>Nonlinear least squares problem </dd></dl>

<p>Definition at line <a class="el" href="a00868_source.html#l00072">72</a> of file <a class="el" href="a00868_source.html">nlls_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0fad568a9f82d6f4e94ebf73ad1aaccd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int FullPhysics::IterativeSolver::num_accepted_steps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of the accepted steps. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of the accepted steps </dd></dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00095">95</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1d81ce0f4c9e8efafbbd23c23e7a269c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FullPhysics::ConnorSolverMAP::number_divergent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of divergent steps for the last problem solved. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00101">101</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2563b65563de033007dbd2917937d256"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FullPhysics::ConnorSolverMAP::number_iteration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of iterations for the last problem solved. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00094">94</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3f8108048f2c1a3c7bbbdd013f03c14c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FullPhysics::ConnorSolverMAP::outcome_flag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Outcome flag. This is an integer version of <a class="el" href="a00152.html#ae80086617c04b5be0cee34f8b9867e23">FitStatistic::OUTCOME</a>. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00108">108</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a77aa5ef807ed695fe12e215834190980"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FullPhysics::ConnorSolverMAP::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>Os</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints description of object. </p>

<p>Reimplemented from <a class="el" href="a00364.html#ae41d1ced6e434896dbf623b27bacae11">FullPhysics::NLLSSolver</a>.</p>

<p>Definition at line <a class="el" href="a00608_source.html#l00125">125</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="adb52c1f4ab60cbabfdcb8aa32fac7b20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="a00415.html">FullPhysics::Printable</a>&lt; <a class="el" href="a00217.html">IterativeSolver</a>  &gt;::print_to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print to string. </p>
<p>This is primarily useful for SWIG wrappers to this class, e.g. a to_s method in ruby. </p>

<p>Definition at line <a class="el" href="a01088_source.html#l00031">31</a> of file <a class="el" href="a01088_source.html">printable.h</a>.</p>

</div>
</div>
<a class="anchor" id="a27a6d6002b04d3f21be8258a0e90a9bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FullPhysics::IterativeSolver::record_accepted_point </td>
          <td>(</td>
          <td class="paramtype">const blitz::Array&lt; double, 1 &gt; &amp;&#160;</td>
          <td class="paramname"><em>point</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called to record an accepted point. </p>
<p>This method is called to record an accepted point. It is the responsibility of the implementer of the <a class="el" href="a00217.html#ae292838898d1d0836dc0c6d7f16fa6f9" title="The method that solves the optimization problem. ">solve()</a> method to record the accepted points. The accepted points must be recorded in the same order that they are achieved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">point</td><td>an accepted point in the parameter space </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00227">227</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="af982397b15209de479477b2604717871"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FullPhysics::IterativeSolver::record_cost_at_accepted_point </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cost</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called to record the cost function value at an accepted point. </p>
<p>This method is called to record the cost function value at an accepted point. It is the responsibility of the implementer of the <a class="el" href="a00217.html#ae292838898d1d0836dc0c6d7f16fa6f9" title="The method that solves the optimization problem. ">solve()</a> method to record the cost function values at the accepted points. The cost values must be recorded in the same order that they are evaluated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cost</td><td>cost funciotn value at an accepted point in the parameter space </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00245">245</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="acae9aa2825e60454d25c3ce201af12c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FullPhysics::IterativeSolverDer::record_gradient_at_accepted_point </td>
          <td>(</td>
          <td class="paramtype">const blitz::Array&lt; double, 1 &gt; &amp;&#160;</td>
          <td class="paramname"><em>gradient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For recording the gradient of the cost function evaluated at an accepted point. </p>
<p>This method is called to record the gradient of the cost function evaluated at an accepted point. It is the responsibility of the implementer of the <a class="el" href="a00217.html#ae292838898d1d0836dc0c6d7f16fa6f9" title="The method that solves the optimization problem. ">solve()</a> method to record the gradients evaluated at the accepted points. The gradients must be recorded in the same order that they are evaluated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gradient</td><td>gradient of the cost function evaluated at an accepted point in the parameter space </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00850_source.html#l00095">95</a> of file <a class="el" href="a00850_source.html">iterative_solver_der.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab0d67c485668fec2852207810e34d9fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConnorSolverMAP::solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This solves the least squares problem starting at the initial guess. </p>
<p>We don't directly return the solution and related matrices, you can query this object for them after the solver has completed. </p>

<p>Implements <a class="el" href="a00217.html#ae292838898d1d0836dc0c6d7f16fa6f9">FullPhysics::IterativeSolver</a>.</p>

<p>Definition at line <a class="el" href="a00607_source.html#l00058">58</a> of file <a class="el" href="a00607_source.html">connor_solver_map.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a9579c6b1338073e9c713c1e04f44c50a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">status_t</a> FullPhysics::IterativeSolver::status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a value of <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0" title="Enum type for the status of the iterative solver. ">IterativeSolver::status_t</a> type. </p>
<p>This method returns the status of the solver. The status of the solver is initialized to <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a4f6402de0c388c22f2d148bcfa6e228d" title="solve method not called yet ">IterativeSolver::UNTRIED</a>, then it must be set to one of the following values by the implemented version of <a class="el" href="a00217.html#ae292838898d1d0836dc0c6d7f16fa6f9" title="The method that solves the optimization problem. ">solve()</a> method:</p><ul>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a20713b5938508e525d81cd1f0d242e4c" title="solve method called and a solution found ">IterativeSolver::SUCCESS</a></li>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a2d914b2efc926e5be7d27175eb0b4bc5" title="solve method called but did not converge to a solution ">IterativeSolver::CONTINUE</a></li>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a47873968f8cb6a80247bde3561307edb" title="solve method called but an error was encountered ">IterativeSolver::ERROR</a></li>
</ul>
<p>Please, read the comments on <a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0" title="Enum type for the status of the iterative solver. ">IterativeSolver::status_t</a> type and its possible values.</p>
<dl class="section return"><dt>Returns</dt><dd>Solver status </dd></dl>

<p>Definition at line <a class="el" href="a00848_source.html#l00188">188</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a31d2190c446abd256bf0adc82ca6ba54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char *const IterativeSolver::status_str </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the string version of the solver status. </p>
<p>If the method <a class="el" href="a00217.html#a9579c6b1338073e9c713c1e04f44c50a" title="Returns a value of IterativeSolver::status_t type. ">status()</a> returns</p><ul>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a4f6402de0c388c22f2d148bcfa6e228d" title="solve method not called yet ">IterativeSolver::UNTRIED</a>,</li>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a20713b5938508e525d81cd1f0d242e4c" title="solve method called and a solution found ">IterativeSolver::SUCCESS</a>,</li>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a2d914b2efc926e5be7d27175eb0b4bc5" title="solve method called but did not converge to a solution ">IterativeSolver::CONTINUE</a>, or</li>
<li><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0a47873968f8cb6a80247bde3561307edb" title="solve method called but an error was encountered ">IterativeSolver::ERROR</a></li>
</ul>
<p>then <a class="el" href="a00217.html#a31d2190c446abd256bf0adc82ca6ba54" title="Returns the string version of the solver status. ">status_str()</a> will return</p><ul>
<li>"UNTRIED",</li>
<li>"SUCCESS",</li>
<li>"CONTINUE", or</li>
<li>"ERROR"</li>
</ul>
<p>respectively.</p>
<dl class="section return"><dt>Returns</dt><dd>Solver status in string form </dd></dl>

<p>Definition at line <a class="el" href="a00847_source.html#l00014">14</a> of file <a class="el" href="a00847_source.html">iterative_solver.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af8151e8281ad0cb5936fd3362a0a77e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">blitz::Array&lt;double, 1&gt; FullPhysics::ConnorSolverMAP::x_update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the a priori of the last problem solved. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00116">116</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ad6643af553c077ab1b469688450e0c39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00118.html">ConvergenceCheck</a>&gt; FullPhysics::ConnorSolverMAP::convergence_check_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The convergence check object. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00174">174</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3bf9a8bcdb3c3a5e09d1310a9b22ed21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">blitz::Array&lt;double, 1&gt; FullPhysics::ConnorSolverMAP::dx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is <img class="formulaInl" alt="$d{x}_{i + 1}$" src="form_11.png"/> the update to <img class="formulaInl" alt="$\mathbf{x}_i$" src="form_12.png"/>, <img class="formulaInl" alt="$\mathbf{y} - \mathbf{F}(\mathbf{x}_i)$" src="form_10.png"/>. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00167">167</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0afeddb3a8dce64fcc3a4160c8051777"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::IterativeSolver::dX_tol_abs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00848_source.html#l00260">260</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a91f034cec23dd9567cc047af41a904c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::IterativeSolver::dX_tol_rel</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00848_source.html#l00260">260</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4810c323a772984382fdcc6c15602bf5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string FullPhysics::ConnorSolverMAP::fname_test_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If this isn't an empty string, save to this file in the first iteration. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00137">137</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a395d9eb4db3625e59e21b16a2ce1a6cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00152.html">FitStatistic</a> FullPhysics::ConnorSolverMAP::fstat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Results from last fit step. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00157">157</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5700d09c82c6e5e351c88a8408607481"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::IterativeSolverDer::G_tol_abs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00850_source.html#l00109">109</a> of file <a class="el" href="a00850_source.html">iterative_solver_der.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3403f2fbb3c08ecb62470759a8c74b13"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::ConnorSolverMAP::gamma</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Levenberg-Marquardt <img class="formulaInl" alt="$\gamma$" src="form_7.png"/> parameter. </p>
<p>This gets updated in each iteration in "solve" </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00145">145</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab3ac957c34ec144b6f50a00865b7b270"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::ConnorSolverMAP::gamma_initial</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initial value of gamma. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00179">179</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4966f53d4cfa86ea57795bad9763e41c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::ConnorSolverMAP::gamma_last_step_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stash gamma from last step we processed. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00151">151</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a52a2fb1dc3c965cdea6d879c7e5db31c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00341.html">MaxAPosteriori</a>&gt; FullPhysics::ConnorSolverMAP::map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00608_source.html#l00184">184</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad78d9d2767f3ee53f52d0d57148b7ca5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FullPhysics::IterativeSolver::max_cost_f_calls</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00848_source.html#l00259">259</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a60f65f85f3cc0f937c39626a589733e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00361.html">NLLSProblem</a>&gt; FullPhysics::NLLSSolver::P</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00868_source.html#l00086">86</a> of file <a class="el" href="a00868_source.html">nlls_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a240449ed16d0822b51071de8fdbdf8ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ConnorSolverMAP::rcond = 1e-12</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Factor to determine if we treat a singular factor as 0. </p>
<p>This is Rcond in solve_least_squares routine. </p>

<p>Definition at line <a class="el" href="a00608_source.html#l00181">181</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac04a82509ebf348c7c1e4895fa223b1b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00443.html">boost::shared_ptr</a>&lt;<a class="el" href="a00362.html">NLLSProblemScaled</a>&gt; FullPhysics::ConnorSolverMAP::scaled_p</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00608_source.html#l00185">185</a> of file <a class="el" href="a00608_source.html">connor_solver_map.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2c54bf6f447542be16f78f6da78261b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00217.html#a8cef3cf27ce873edf2870083cf9b0de0">status_t</a> FullPhysics::IterativeSolver::stat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00848_source.html#l00262">262</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1db313c529ed9d698ddbb175cf86e4d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FullPhysics::IterativeSolver::verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00848_source.html#l00263">263</a> of file <a class="el" href="a00848_source.html">iterative_solver.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Implementation/<a class="el" href="a00608_source.html">connor_solver_map.h</a></li>
<li>Implementation/<a class="el" href="a00607_source.html">connor_solver_map.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<hr size="1">
<address style="align: right;"><small>
<center>
Copyright &copy 2017, California Institute of Technology.<br/>
            ALL RIGHTS RESERVED.<br/>
  U.S. Government Sponsorship acknowledged.<br/>
  Generated Tue Dec 19 2017 12:14:44
</center></small></address>
</body>
</html>
