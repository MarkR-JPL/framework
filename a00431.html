<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ReFRACtor: FullPhysics::RegisterLua Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ReFRACtor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00431.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="a03091.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FullPhysics::RegisterLua Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class handles the registration of luabind class wrappers with Lua.  
 <a href="a00431.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00930_source.html">register_lua.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for FullPhysics::RegisterLua:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="a03092.png" border="0" usemap="#_full_physics_1_1_register_lua_coll__map" alt="Collaboration graph"/></div>
<map name="_full_physics_1_1_register_lua_coll__map" id="_full_physics_1_1_register_lua_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac976ee76f8219ec6613e6c022c234fea"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00431.html#ac976ee76f8219ec6613e6c022c234fea">add_file_and_line</a> (lua_State *ls)</td></tr>
<tr class="separator:ac976ee76f8219ec6613e6c022c234fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c597728e89bae4c1dbc8ca72c4e7f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00431.html#ad2c597728e89bae4c1dbc8ca72c4e7f9">register_lua</a> (lua_State *ls)</td></tr>
<tr class="separator:ad2c597728e89bae4c1dbc8ca72c4e7f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class handles the registration of luabind class wrappers with Lua. </p>
<p>One approach to this is to have a central function that registers everything, and as we add classes update that central function. An alternative is the one selected here, were we have a more decentralized registration. Classes set up the registration in their own area, and then simple get listed and needing registration in the file "register_lua.cc". It would be nice to decentralize this completely, but I could never figure out a way to actually do this.</p>
<p>So registration involves 2 steps:</p>
<ol type="1">
<li>Add the registration code to the class code (e.g., for Foo, this is the file "foo.cc").</li>
<li>Add the class to the list of classes in the function <a class="el" href="a00431.html#ad2c597728e89bae4c1dbc8ca72c4e7f9">RegisterLua::register_lua</a> found at "lib/Lua/register_lua.cc"</li>
</ol>
<p>The registration code is cookie cutter, so we have macros to help do this. The registration is different depending on if we have a derived class with a base class, or a class that doesn't derive from another (or at least one that we want to tell Lua about).</p>
<p>An example of this:</p>
<p>In <a class="el" href="a00851.html">level_1b.cc</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#ifdef HAVE_LUA</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00930.html">register_lua.h</a>&quot;</span></div><div class="line"><a class="code" href="a00930.html#a7e3dc45e143a780b5613b81f111742ab">REGISTER_LUA_CLASS</a>(Level1b)</div><div class="line"><a class="code" href="a00930.html#a93c540a3927ad20bf4245b5a53eb3122">REGISTER_LUA_END</a>()</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>In level_1b_hdf.cc: </p><div class="fragment"><div class="line"><span class="preprocessor">#ifdef HAVE_LUA</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00930.html">register_lua.h</a>&quot;</span></div><div class="line"><a class="code" href="a00930.html#abb3283e2349f821763f26e20b716e499">REGISTER_LUA_DERIVED_CLASS</a>(Level1bAcos, Level1b)</div><div class="line">  .def(luabind::constructor&lt;std::string, std::string&gt;())</div><div class="line"><a class="code" href="a00930.html#a93c540a3927ad20bf4245b5a53eb3122">REGISTER_LUA_END</a>()</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>Then in <a class="el" href="a00929.html">register_lua.cc</a>, we add </p><div class="fragment"><div class="line"><a class="code" href="a00930.html#a949427530fed2bd1ca54322781455a1f">REGISTER_LUA_LIST</a>(Level1b);</div><div class="line"><a class="code" href="a00930.html#a949427530fed2bd1ca54322781455a1f">REGISTER_LUA_LIST</a>(Level1Hdf);</div></div><!-- fragment --><p>Note that you don't need to put all the member functions into the Lua registration, just the ones you want to call in Lua. For many classes, this will just be the constructors. We use Lua configuration files for creating the objects needed in Level 2 Full physics, not to do major computation with it. That is more what we do with the <a class="el" href="a01135.html">Python</a> wrappers. Lua is a small language that is ideal for integration in the C++ code, but it is no replacement for <a class="el" href="a01135.html">Python</a>, nor is it meant to be.</p>
<p>Pretty much all our classes are <a class="el" href="a00415.html" title="This is a Mixin for classes that can be printed. ">Printable</a>. We've put the magic incantation in place for classes in the macros (this ties the Lua function __tostring to the C++ code print_to_string). If you have a class that is not printable, we'll need to add a macro to support that.</p>
<p>We normally use Lua through our C++ code. It can be useful, particularly when testing, to go the other way. We define the function "luaopen_refractor" to go the other way, call in Lua like:</p>
<div class="fragment"><div class="line">require(<span class="stringliteral">&quot;librefractor&quot;</span>)</div></div><!-- fragment --><p>Note that you should use the installed library, like we do with python (i.e., do a "make install").</p>
<p>You will need to make sure that the library is on the PATH. Lua uses an odd syntax for its path, an example of using it would be</p>
<div class="fragment"><div class="line">LUA_CPATH=install/lib/?.so lua</div><div class="line">require <span class="stringliteral">&quot;librefractor&quot;</span></div><div class="line">l1b = Level1bAcos(<span class="stringliteral">&quot;filename&quot;</span>,<span class="stringliteral">&quot;soundingid&quot;</span>)</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="a00930_source.html#l00105">105</a> of file <a class="el" href="a00930_source.html">register_lua.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac976ee76f8219ec6613e6c022c234fea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int FullPhysics::RegisterLua::add_file_and_line </td>
          <td>(</td>
          <td class="paramtype">lua_State *&#160;</td>
          <td class="paramname"><em>ls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad2c597728e89bae4c1dbc8ca72c4e7f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FullPhysics::RegisterLua::register_lua </td>
          <td>(</td>
          <td class="paramtype">lua_State *&#160;</td>
          <td class="paramname"><em>ls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00929_source.html#l00119">119</a> of file <a class="el" href="a00929_source.html">register_lua.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Lua/<a class="el" href="a00930_source.html">register_lua.h</a></li>
<li>Lua/<a class="el" href="a00929_source.html">register_lua.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<hr size="1">
<address style="align: right;"><small>
<center>
Copyright &copy 2017, California Institute of Technology.<br/>
            ALL RIGHTS RESERVED.<br/>
  U.S. Government Sponsorship acknowledged.<br/>
  Generated Tue Dec 19 2017 12:14:46
</center></small></address>
</body>
</html>
