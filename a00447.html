<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ReFRACtor: FullPhysics::SolarAbsorptionGfitFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ReFRACtor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00447.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="a03121.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FullPhysics::SolarAbsorptionGfitFile Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class calculates the solar absorption spectrum.  
 <a href="a00447.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00754_source.html">solar_absorption_gfit_file.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for FullPhysics::SolarAbsorptionGfitFile:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="a03122.png" border="0" usemap="#_full_physics_1_1_solar_absorption_gfit_file_inherit__map" alt="Inheritance graph"/></div>
<map name="_full_physics_1_1_solar_absorption_gfit_file_inherit__map" id="_full_physics_1_1_solar_absorption_gfit_file_inherit__map">
<area shape="rect" id="node2" href="a00448.html" title="This class calculates the solar absorption spectrum. " alt="" coords="5,271,204,392"/>
<area shape="rect" id="node3" href="a00415.html" title="{FullPhysics::Printable\l\&lt; SolarAbsorptionSpectrum \&gt;\n||+ print_to_string()\l}" alt="" coords="7,131,202,223"/>
<area shape="rect" id="node4" href="a00171.html" title="For use with SWIG, it is useful to have a base class that everything can be cast to. " alt="" coords="14,5,195,83"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for FullPhysics::SolarAbsorptionGfitFile:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="a03123.png" border="0" usemap="#_full_physics_1_1_solar_absorption_gfit_file_coll__map" alt="Collaboration graph"/></div>
<map name="_full_physics_1_1_solar_absorption_gfit_file_coll__map" id="_full_physics_1_1_solar_absorption_gfit_file_coll__map">
<area shape="rect" id="node2" href="a00448.html" title="This class calculates the solar absorption spectrum. " alt="" coords="5,271,204,392"/>
<area shape="rect" id="node3" href="a00415.html" title="{FullPhysics::Printable\l\&lt; SolarAbsorptionSpectrum \&gt;\n||+ print_to_string()\l}" alt="" coords="7,131,202,223"/>
<area shape="rect" id="node4" href="a00171.html" title="For use with SWIG, it is useful to have a base class that everything can be cast to. " alt="" coords="14,5,195,83"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a15ed40256837cd885f7aef46115ad1ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00447.html#a15ed40256837cd885f7aef46115ad1ab">SolarAbsorptionGfitFile</a> (const std::string &amp;Line_list_file, double Fraction_solar_diameter=1.0)</td></tr>
<tr class="memdesc:a15ed40256837cd885f7aef46115ad1ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the given line list file, and use for calculating the solar absorption spectrum.  <a href="#a15ed40256837cd885f7aef46115ad1ab">More...</a><br /></td></tr>
<tr class="separator:a15ed40256837cd885f7aef46115ad1ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa49c8809ec9dfb04a091c1d8e5cc92"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00447.html#adaa49c8809ec9dfb04a091c1d8e5cc92">~SolarAbsorptionGfitFile</a> ()</td></tr>
<tr class="separator:adaa49c8809ec9dfb04a091c1d8e5cc92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137e5adb8ac8a9ba7657e896d306efdb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00447.html#a137e5adb8ac8a9ba7657e896d306efdb">fraction_solar_diameter</a> () const </td></tr>
<tr class="memdesc:a137e5adb8ac8a9ba7657e896d306efdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fraction of solar diameter that we view.  <a href="#a137e5adb8ac8a9ba7657e896d306efdb">More...</a><br /></td></tr>
<tr class="separator:a137e5adb8ac8a9ba7657e896d306efdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae524b81ed89d91547fecb5d84b9d6976"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00447.html#ae524b81ed89d91547fecb5d84b9d6976">print</a> (std::ostream &amp;Os) const </td></tr>
<tr class="memdesc:ae524b81ed89d91547fecb5d84b9d6976"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print description of object.  <a href="#ae524b81ed89d91547fecb5d84b9d6976">More...</a><br /></td></tr>
<tr class="separator:ae524b81ed89d91547fecb5d84b9d6976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00415.html#adb52c1f4ab60cbabfdcb8aa32fac7b20">print_to_string</a> () const</td></tr>
<tr class="memdesc:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print to string.  <a href="#adb52c1f4ab60cbabfdcb8aa32fac7b20">More...</a><br /></td></tr>
<tr class="separator:adb52c1f4ab60cbabfdcb8aa32fac7b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3cdc474f3fc391c45896c7f6c7296d5"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="a00472.html">Spectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00447.html#ab3cdc474f3fc391c45896c7f6c7296d5">solar_absorption_spectrum</a> (const <a class="el" href="a00465.html">SpectralDomain</a> &amp;spec_domain) const </td></tr>
<tr class="memdesc:ab3cdc474f3fc391c45896c7f6c7296d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This calculates the solar absorption spectrum.  <a href="#ab3cdc474f3fc391c45896c7f6c7296d5">More...</a><br /></td></tr>
<tr class="separator:ab3cdc474f3fc391c45896c7f6c7296d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class calculates the solar absorption spectrum. </p>
<p>This particular implementation reads the GFIT format absorption line list file. This is a fixed record file format that gives the absorption line list data.</p>
<p>From the Fortran code:</p>
<p>Calculates the solar optical thickness spectrum (SOT) at any wavelengths.</p>
<p>Taking the exponential of SOT produces the solar spectrum as it would be observed at infinite spectral resolution.</p>
<p>All solar lines are assumed to have a shape of the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[SOT = s \exp\left(-\frac{x^2}{\sqrt{d^4+x^2 y^2}}\right)\]" src="form_13.png"/>
</p>
<p> where </p><dl>
<dt>s</dt>
<dd>is the line-center optical thickness (dimensionless) </dd>
<dt>x</dt>
<dd>is the frequency from line center (cm-1) </dd>
<dt>y</dt>
<dd>is the 1/e folding width (cm-1) </dd>
<dt>d</dt>
<dd>is the Doppler width (cm-1) </dd>
</dl>
<p>In the doppler limit, i.e. <img class="formulaInl" alt="$ d^2 \gg x.y $" src="form_14.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[SOT = s \exp\left(-{\frac{x}{d}}^2\right)\]" src="form_15.png"/>
</p>
<p>In the far line wing limit, i.e. <img class="formulaInl" alt="$x y \gg d^2$" src="form_16.png"/>, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[SOT = s \exp\left(- \left|\frac{x}{y}\right|\right)\]" src="form_17.png"/>
</p>
<p>So near the line center, the lineshape is Doppler, but in the line wings it decays exponentially (if y&gt;0).</p>
<p>This choice of lineshape has no physical basis. It just seems to give a reasonable representation is nearly all cases. The only cases in which this lineshape does not give an adequate representation of the absorption are the extremely broad lines of light atmos such as H (atomic hydrogen) or Mg. However, by representing the H absorptions as superpositions of two lines, one narrow and the other broad, adequate results were obtained.</p>
<p>Molecular absorptions (e.g. CO, OH, NH, CN) tend to have narrow, Doppler lineshapes because they are confined to a relatively narrow layer in the cooler, upper, part of the solar atmosphere. In the hotter depths they are dissociated.</p>
<p>Atomic transitions, on the other hand, are formed over a much wider range of solar altitudes, and hence temperatures. This gives rise to line shapes whose wings decay in an approximately exponential manner with the distance from line center. The line shape of equation (1) does a reasonable job in both cases.</p>
<p>This subroutine also makes allowances for the effect of the finite FOV of the observing instrument, which gives rise to:</p>
<ol type="1">
<li>broadening of the solar lines due to the linear variation of the Doppler shift from solar rotation across the solar disk.</li>
<li>deepening of the solar lines due to limb darkening. It assumes that an instrument which observes the entire solar disk will observe lines which are, on average, twice the strength of an instrument just observing the center of the disk.</li>
</ol>
<dl class="todo"><dt><b><a class="el" href="a00001.html#_todo000021">Todo:</a></b></dt><dd>Note that the Fraction_solar_diameter parameter is completely ignored, the underlying Fortran code ignores this value and sets the variable "sld" to 1.0 regardless of the Fraction_solar_diameter passed in. </dd></dl>

<p>Definition at line <a class="el" href="a00754_source.html#l00081">81</a> of file <a class="el" href="a00754_source.html">solar_absorption_gfit_file.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a15ed40256837cd885f7aef46115ad1ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SolarAbsorptionGfitFile::SolarAbsorptionGfitFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Line_list_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Fraction_solar_diameter</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the given line list file, and use for calculating the solar absorption spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Line_list_file</td><td>Line list file </td></tr>
    <tr><td class="paramname">Fraction_solar_diameter</td><td>Fraction of Solar diameter viewed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00753_source.html#l00027">27</a> of file <a class="el" href="a00753_source.html">solar_absorption_gfit_file.cc</a>.</p>

</div>
</div>
<a class="anchor" id="adaa49c8809ec9dfb04a091c1d8e5cc92"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual FullPhysics::SolarAbsorptionGfitFile::~SolarAbsorptionGfitFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00754_source.html#l00085">85</a> of file <a class="el" href="a00754_source.html">solar_absorption_gfit_file.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a137e5adb8ac8a9ba7657e896d306efdb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FullPhysics::SolarAbsorptionGfitFile::fraction_solar_diameter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fraction of solar diameter that we view. </p>

<p>Definition at line <a class="el" href="a00754_source.html#l00093">93</a> of file <a class="el" href="a00754_source.html">solar_absorption_gfit_file.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae524b81ed89d91547fecb5d84b9d6976"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SolarAbsorptionGfitFile::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>Os</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print description of object. </p>

<p>Reimplemented from <a class="el" href="a00448.html#a7134d222c2ed64d22931bf590bf879c5">FullPhysics::SolarAbsorptionSpectrum</a>.</p>

<p>Definition at line <a class="el" href="a00753_source.html#l00037">37</a> of file <a class="el" href="a00753_source.html">solar_absorption_gfit_file.cc</a>.</p>

</div>
</div>
<a class="anchor" id="adb52c1f4ab60cbabfdcb8aa32fac7b20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="a00415.html">FullPhysics::Printable</a>&lt; <a class="el" href="a00448.html">SolarAbsorptionSpectrum</a>  &gt;::print_to_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print to string. </p>
<p>This is primarily useful for SWIG wrappers to this class, e.g. a to_s method in ruby. </p>

<p>Definition at line <a class="el" href="a01088_source.html#l00031">31</a> of file <a class="el" href="a01088_source.html">printable.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab3cdc474f3fc391c45896c7f6c7296d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00472.html">Spectrum</a> SolarAbsorptionGfitFile::solar_absorption_spectrum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00465.html">SpectralDomain</a> &amp;&#160;</td>
          <td class="paramname"><em>Spec_domain</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This calculates the solar absorption spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Spec_domain</td><td>Wavenumber/Wavelength to return solar absorption spectrum for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The solar absorption spectrum. This is unit less, it is a scaled value with 1.0 being no absorption.</dd></dl>
<p>Note that the spectral domain here is in the solar rest frame, <em>not</em> the earth rest frame used in most other places. The class <a class="el" href="a00445.html" title="This applies a solar model to radiances to model the incoming solar irradiance. ">SolarAbsorptionAndContinuum</a> handles this conversion internally. </p>

<p>Implements <a class="el" href="a00448.html#a85d7c441911fe1009d1b9eec2bb62502">FullPhysics::SolarAbsorptionSpectrum</a>.</p>

<p>Definition at line <a class="el" href="a00753_source.html#l00044">44</a> of file <a class="el" href="a00753_source.html">solar_absorption_gfit_file.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Implementation/<a class="el" href="a00754_source.html">solar_absorption_gfit_file.h</a></li>
<li>Implementation/<a class="el" href="a00753_source.html">solar_absorption_gfit_file.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<hr size="1">
<address style="align: right;"><small>
<center>
Copyright &copy 2017, California Institute of Technology.<br/>
            ALL RIGHTS RESERVED.<br/>
  U.S. Government Sponsorship acknowledged.<br/>
  Generated Tue Dec 19 2017 12:14:46
</center></small></address>
</body>
</html>
